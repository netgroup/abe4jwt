Open-Source Fixedpoint Model-Checker version 2020
Verified for 1 sessions
INPUT:
   oidc.anb
SUMMARY:
  ATTACK_FOUND
GOAL:
  weak_auth
BACKEND:
  Open-Source Fixedpoint Model-Checker version 2020
STATISTICS:
  TIME 13008 ms
  parseTime 4 ms
  visitedNodes: 3063 nodes
  depth: 9 plies

ATTACK TRACE:
(x1201,1) -> i: Scope(1)
(x1201,2) -> i: Scope(2)
i -> (x1201,1): {Scope(1),as,x407}_inv(authChCr(i))
i -> (x1201,2): {Scope(2),as,x607}_inv(authChCr(i))

#C(1) asks for code using Scope(1)
(x1201,1) -> i: pseudonym(x1201),{|i,Scope(1),State(3),Nonce(3)|}_(secChCr(pseudonym(x1201),as))
i -> (as,1): pseudonym(x1201),{|i,Scope(1),State(3),Nonce(3)|}_(secChCr(pseudonym(x1201),as))
(as,1) -> i: State(3),code(Scope(1),State(3),Nonce(3)),Scope(1)

#C(2) asks for code using Scope(2)
(x1201,2) -> i: pseudonym(x1201),{|i,Scope(2),State(5),Nonce(5)|}_(secChCr(pseudonym(x1201),as))
i -> (as,2): pseudonym(x1201),{|i,Scope(2),State(5),Nonce(5)|}_(secChCr(pseudonym(x1201),as))
(as,2) -> i: State(5),code(Scope(2),State(5),Nonce(5)),Scope(2)

#C(1) is returned a code associated to Scope(2)
i -> (x1201,1): State(3),code(Scope(2),State(5),Nonce(5)),Scope(1)

#C(1)'s code4token exchange 
(x1201,1) -> i: pseudonym(x1201),{|x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5))|}_(secChCr(pseudonym(x1201),as))
i -> (as,2): pseudonym(x1201),{|x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5))|}_(secChCr(pseudonym(x1201),as))
(as,2) -> i: {|{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),code(Scope(2),State(5),Nonce(5))|}_(secChCr(as,pseudonym(x1201)))
i -> (x1201,1): {|{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),code(Scope(2),State(5),Nonce(5))|}_(secChCr(as,pseudonym(x1201)))

#C(1) presents the wrong token
(x1201,1) -> i: pseudonym(x1201),{|{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),x407|}_(secChCr(pseudonym(x1201),i))
i -> (x1201,1): {|x1112,x407|}_(secChCr(i,pseudonym(x1201)))


% Reached State:
% 
% request(x1201,as,pCasStateScopecodeScopeStateNonce,State(3),Scope(1),code(Scope(2),State(5),Nonce(5)),1)
% contains(secrecyset(x1201,1,pData),x1201)
% contains(secrecyset(x1201,1,pData),i)
% secrets(x1112,secrecyset(x1201,1,pData),i)
% request(x1201,i,pCRSData,x1112,1)
% state_rC(x1201,5,hash,pw(as,x1201),pk(as),i,Scope(1),x407,as,Scope(1),as,x407,State(3),Nonce(3),i,Scope(1),State(3),Nonce(3),code(Scope(2),State(5),Nonce(5)),State(3),code(Scope(2),State(5),Nonce(5)),Scope(1),x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5)),resource(code(Scope(2),State(5),Nonce(5))),{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),code(Scope(2),State(5),Nonce(5)),{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),x407,x1112,x1112,x407,1)
% state_rRS(x34,0,pk(as),as,2)
% state_rC(x1201,2,hash,pw(as,x1201),pk(as),i,Scope(2),x607,as,Scope(2),as,x607,State(5),Nonce(5),i,Scope(2),State(5),Nonce(5),2)
% state_ras(as,2,hash,resource,code,pw(as,x1201),x1201,inv(pk(as)),pk(as),Nonce(5),State(5),Scope(2),i,i,Scope(2),State(5),Nonce(5),pseudonym(x1201),State(5),code(Scope(2),State(5),Nonce(5)),Scope(2),code(Scope(2),State(5),Nonce(5)),x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5)),{resource(code(Scope(2),State(5),Nonce(5))),x1201,as,i}_inv(pk(as)),code(Scope(2),State(5),Nonce(5)),2)
% state_rRS(x29,0,pk(as),as,1)
% state_ras(as,1,hash,resource,code,pw(as,x27),x27,inv(pk(as)),pk(as),Nonce(3),State(3),Scope(1),i,i,Scope(1),State(3),Nonce(3),pseudonym(x1201),State(3),code(Scope(1),State(3),Nonce(3)),Scope(1),1)
% witness(as,x27,pCasStateScopecodeScopeStateNonce,State(3),Scope(1),code(Scope(1),State(3),Nonce(3)))
% witness(as,x1201,pCasStateScopecodeScopeStateNonce,State(5),Scope(2),code(Scope(2),State(5),Nonce(5)))
% witness(x1201,as,pasCCpwasCcodeScopeStateNonce,x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5)))
% wrequest(as,x1201,pasCCpwasCcodeScopeStateNonce,x1201,pw(as,x1201),code(Scope(2),State(5),Nonce(5)),i)
% witness(x1201,i,pRSCRSresourcecodeScopeStateNonceCasSession,i,resource(code(Scope(2),State(5),Nonce(5))),x1201,as,x407)